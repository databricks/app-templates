bundle:
  name: agent-langchain-ts

variables:
  serving_endpoint_name:
    description: "The name of the Databricks model serving endpoint to use"
    default: "databricks-claude-sonnet-4-5"

  resource_name_suffix:
    description: "Suffix to add to resource names for uniqueness"
    default: "dev"

  mlflow_experiment_id:
    description: "MLflow experiment ID for traces (optional - will be created if not provided)"
    default: ""

include:
  - resources/*.yml

resources:
  experiments:
    agent_tracing_experiment:
      name: /Users/${workspace.current_user.userName}/agent-langchain-ts

  apps:
    agent_langchain_ts:
      name: agent-lc-ts-${var.resource_name_suffix}
      description: "TypeScript LangChain agent with MLflow tracing"
      source_code_path: ./
      resources:
        - name: serving-endpoint
          serving_endpoint:
            name: ${var.serving_endpoint_name}
            permission: CAN_QUERY

        # MLflow experiment for tracing (references experiment defined above)
        - name: experiment
          experiment:
            experiment_id: ${resources.experiments.agent_tracing_experiment.id}
            permission: CAN_MANAGE

        # Add additional resources here as needed:
        # - Unity Catalog tables, functions, or vector search indexes
        # - Genie spaces for natural language data queries
        # - External MCP servers
        # See .claude/skills/add-tools/ for examples

targets:
  dev:
    mode: development
    default: true
    workspace:
      profile: dogfood

  prod:
    mode: production
    workspace:
      profile: dogfood

    # Production-specific configuration
    variables:
      resource_name_suffix:
        default: "prod"
